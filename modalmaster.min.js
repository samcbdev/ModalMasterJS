!function(o){const e={stack:[],config:{outsideClickClose:!1,scrollLock:!0,escToClose:!1,animation:!1,animationSpeed:300,zIndexBase:1e3},callbacks:{},setGlobalConfig(o={}){Object.assign(e.config,o)},registerCallbacks(o,a={}){e.callbacks[o]=a},invokeCallback(o,a,t){const n=e.callbacks[o]?.[a];"function"==typeof n&&n(t)},getConfig(o,a){const t=a.replace(/([A-Z])/g,"-$1").toLowerCase();let n=o.data(t);if("string"==typeof n){if("true"===n)return!0;if("false"===n)return!1;const o=parseFloat(n);if(!isNaN(o))return o}return void 0!==n?n:e.config[a]},open(e){const a=o(".customModal."+e);a.length&&a.modalOpen()},close(e){const a=o(".customModal."+e);a.length&&a.modalClose()},openAjax(a,t){const n=o(".customModal."+a);n.length&&(n.trigger("modal:ajaxLoad"),e.invokeCallback(a,"onAjaxLoad",n),n.find(".ajaxTarget").load(t,(function(o,t){"error"===t?(n.trigger("modal:ajaxError"),e.invokeCallback(a,"onAjaxError",n)):(e.invokeCallback(a,"onAjaxSuccess",n),n.modalOpen())})))},on(e,a,t){o(".customModal."+e).on(a,t)},init(){o(document).on("click",".openModalTrigger",(function(){const a=o(this).data("modal-target");a&&e.open(a)})),o(document).on("click","[data-close-modal]",(function(e){e.stopPropagation();const a=o(this).closest(".customModal");a.length&&a.modalClose()})),o(document).on("mousedown.modalOutside",(function(e){o(document).data("ModalMaster_mouseDownTarget",e.target)})),o(document).on("mouseup.modalOutside",(function(a){const t=o(document).data("ModalMaster_mouseDownTarget");o(".customModal.showModal").each((function(){const n=o(this);if(!e.getConfig(n,"outsideClickClose"))return;if(Date.now()-(n.data("ModalMaster_openTime")||0)<150)return;const s=!o(t).closest(".modalContent").length,l=!o(a.target).closest(".modalContent").length;s&&l&&n.modalClose()}))})),o(document).off("keydown.modalEsc").on("keydown.modalEsc",(function(o){if("Escape"!==o.key)return;const a=e.stack[e.stack.length-1];if(!a?.length)return;e.getConfig(a,"escToClose")&&a.modalClose()}))}};o.fn.modalOpen=function(){const a=this,t=a.attr("class").split(/\s+/).find((o=>"customModal"!==o)),n=a.is("[data-modal-stack]"),s=!0===e.getConfig(a,"scrollLock")||"true"===e.getConfig(a,"scrollLock"),l=e.getConfig(a,"animation"),i=parseInt(e.getConfig(a,"animationSpeed"),10)||0;if(a.trigger("modal:beforeOpen"),e.invokeCallback(t,"beforeOpen",a),n&&!e.stack.includes(a)){const o=e.config.zIndexBase+e.stack.length;a.css("z-index",o),e.stack.push(a),a.trigger("modal:stacked")}s&&o("body").addClass("modalOpen stopScroll"),a.data("ModalMaster_openTime",Date.now());const c=()=>{a.addClass("showModal").trigger("modal:open"),e.invokeCallback(t,"onOpen",a)};return a.css("display","block"),"fade"===l?a.hide().fadeIn(i,c):"slide"===l?a.hide().slideDown(i,c):c(),a},o.fn.modalClose=function(){const a=this,t=a.attr("class").split(/\s+/).find((o=>"customModal"!==o));if(!a.hasClass("showModal")&&!a.is(":visible"))return this;if(a.data("ModalMaster_isClosing"))return this;a.data("ModalMaster_isClosing",!0);const n=a.is("[data-modal-stack]"),s=!0===e.getConfig(a,"scrollLock")||"true"===e.getConfig(a,"scrollLock"),l=e.getConfig(a,"animation"),i=parseInt(e.getConfig(a,"animationSpeed"),10)||0;a.trigger("modal:beforeClose"),e.invokeCallback(t,"beforeClose",a),n&&(e.stack=e.stack.filter((o=>!o.is(a))),a.trigger("modal:unstacked"));const c=()=>{a.removeClass("showModal").trigger("modal:close"),e.invokeCallback(t,"onClose",a),a.removeData("ModalMaster_openTime"),a.removeData("ModalMaster_isClosing"),a.css("display","none"),s&&0===e.stack.length&&o("body").removeClass("modalOpen stopScroll")};return"fade"===l?a.fadeOut(i,c):"slide"===l?a.slideUp(i,c):c(),a},e.closeAll=function(){for(;e.stack.length>0;){e.stack.pop().modalClose()}},window.ModalMaster=e,o(document).ready(e.init)}(jQuery);